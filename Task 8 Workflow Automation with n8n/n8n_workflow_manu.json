{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "production-alert",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -128,
        -96
      ],
      "id": "a889b0f0-19e2-4570-9f72-e9fc287de8f6",
      "name": "Webhook",
      "webhookId": "e75c47dd-ede7-4d2d-a70e-de1c88642790"
    },
    {
      "parameters": {
        "sendTo": "={{ $json[\"Supervisor Email\"] }}",
        "subject": "âš ï¸ Machine Downtime Alert",
        "message": "=Machine downtime exceeded 4 hours. Details: {{ $json.Summary }} Downtime: {{ $json[\"Downtime Hours\"] }} hours. Efficiency: {{ $json.Efficiency }}% Stock Level: {{ $json[\"Stock Level\"] }}.",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1120,
        -368
      ],
      "id": "8a7c2a4a-c507-419c-91bf-d377a2dde4eb",
      "name": "Send a message",
      "webhookId": "e5aa1355-3a1a-41ea-a6ec-36ba193ad124",
      "credentials": {
        "gmailOAuth2": {
          "id": "gCDfK27hCw4j8c5G",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json[\"Supplier Email\"] }}",
        "subject": "ðŸ“¦ Supplier Alert: Low Stock / Delay",
        "message": "=Supplier Issue Detected: {{ $json[\"Supplier Name\"] }},\n{{ $json.Summary }} \nStock Level: {{ $json[\"Stock Level\"] }}, \nDelivery Delay: {{ $json[\"Delivery Delay (days)\"] }}, \ndays Reliability Score: {{ $json[\"Reliability Score\"] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1120,
        -96
      ],
      "id": "51e3cf91-3439-4e76-8d98-25700efcbc34",
      "name": "Send a message1",
      "webhookId": "3ceafa70-1a07-468c-90c7-f4575165e6a6",
      "credentials": {
        "gmailOAuth2": {
          "id": "gCDfK27hCw4j8c5G",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json[\"Client Manager Email\"] }}",
        "subject": "ðŸ’¼ Client Feedback Alert",
        "message": "=Client Feedback: {{ $json[\"Client Name\"] }}\n\n{{ $json.Summary }} \n\nSentiment Score: {{ $json[\"Sentiment Score\"] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1120,
        176
      ],
      "id": "62d30df9-243c-40f1-86c6-4303d47486f9",
      "name": "Send a message2",
      "webhookId": "146393e2-a2e0-40e0-b9ba-b189f07df760",
      "credentials": {
        "gmailOAuth2": {
          "id": "gCDfK27hCw4j8c5G",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "119905c9-b2b8-442d-bc5d-5e10c2da4c25",
              "leftValue": "={{ $json.body.downtime_hours }}",
              "rightValue": 4,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        512,
        -304
      ],
      "id": "f7418cc6-beaa-4f0f-a195-58fe7a016368",
      "name": "if response from AI Agent and downtime > 4"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "50aea8c1-4463-4a15-b021-297b70220e43",
              "leftValue": "={{ $json.body.stock_level }}",
              "rightValue": 100,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            },
            {
              "id": "4bf86242-4242-40e7-b78e-91cc50b54ef7",
              "leftValue": "={{ $json.body.delivery_delay_days }}",
              "rightValue": 6,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        512,
        -96
      ],
      "id": "bad85e26-7647-442a-997a-132d528c69d9",
      "name": "If response from SQL QA System with some conditions"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e522fe1d-de35-4403-b83b-389bcdb587de",
              "leftValue": "={{ $json.body.sentiment_score }}",
              "rightValue": 3,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        512,
        112
      ],
      "id": "30758771-a13b-46fa-82d2-7b246fad6df4",
      "name": "If response from Sentiment Summarizer and sentiment is low"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.body.source }}",
                    "rightValue": "AI Agent",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    },
                    "id": "d81d7887-e268-4bb3-bb8b-76db58851d9d"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "00f38ddf-1cb8-49e2-b2aa-aad0e1df528c",
                    "leftValue": "={{ $json.body.source }}",
                    "rightValue": "SQL QA System",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "15ac39d3-e7d3-426d-aeb3-993aadfd70e2",
                    "leftValue": "={{ $json.body.source }}",
                    "rightValue": "Sentiment Summarizer",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        128,
        -112
      ],
      "id": "4d44b551-8c84-4a01-b253-3474022e0098",
      "name": "Switch node for the response from Agents"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI",
          "mode": "list",
          "cachedResultName": "Workflow Automation with n8n",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "AI_Agent_Alerts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Timestamp": "={{$now}}",
            "Source": "={{ $json.body.source }}",
            "Summary": "={{ $json.body.summary }}",
            "Downtime Hours": "={{ $json.body.downtime_hours }}",
            "Efficiency": "={{ $json.body.efficiency }}",
            "Stock Level": "={{ $json.body.stock_level }}",
            "Supervisor Email": "={{ $json.body.supervisor_email }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Source",
              "displayName": "Source",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Summary",
              "displayName": "Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Downtime Hours",
              "displayName": "Downtime Hours",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Efficiency",
              "displayName": "Efficiency",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Stock Level",
              "displayName": "Stock Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Supervisor Email",
              "displayName": "Supervisor Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        864,
        -368
      ],
      "id": "c0e05488-9b6e-4ea5-abab-3899e1843086",
      "name": "Append row in AI_Agent_Alerts",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TmejcAPR1YSqhJ6Y",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI",
          "mode": "list",
          "cachedResultName": "Workflow Automation with n8n",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1986915651,
          "mode": "list",
          "cachedResultName": "SQL_QA_Alerts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI/edit#gid=1986915651"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Timestamp": "={{$now}}",
            "Source": "={{ $json.body.source }}",
            "Summary": "={{ $json.body.summary }}",
            "Supplier Name": "={{ $json.body.supplier_name }}",
            "Delivery Delay (days)": "={{ $json.body.delivery_delay_days }}",
            "Reliability Score": "={{ $json.body.reliability_score }}",
            "Stock Level": "={{ $json.body.stock_level }}",
            "Supplier Email": "={{ $json.body.supplier_email }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Source",
              "displayName": "Source",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Summary",
              "displayName": "Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Supplier Name",
              "displayName": "Supplier Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Delivery Delay (days)",
              "displayName": "Delivery Delay (days)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Reliability Score",
              "displayName": "Reliability Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Stock Level",
              "displayName": "Stock Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Supplier Email",
              "displayName": "Supplier Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        864,
        -96
      ],
      "id": "748f75e7-c243-404a-bb7c-3271618237dc",
      "name": "Append row in SQL_QA_Alerts",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TmejcAPR1YSqhJ6Y",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI",
          "mode": "list",
          "cachedResultName": "Workflow Automation with n8n",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1961528925,
          "mode": "list",
          "cachedResultName": "Sentiment_Alerts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IRfIZ-BhQyDE2rz8wHuMFArEDCxcurpNtiXEBFbhrYI/edit#gid=1961528925"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Timestamp": "={{$now}}",
            "Source": "={{ $json.body.source }}",
            "Summary": "={{ $json.body.summary }}",
            "Client Name": "={{ $json.body.client_name }}",
            "Sentiment Score": "={{ $json.body.sentiment_score }}",
            "Client Manager Email": "={{ $json.body.client_manager_email }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Source",
              "displayName": "Source",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Summary",
              "displayName": "Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Client Name",
              "displayName": "Client Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Sentiment Score",
              "displayName": "Sentiment Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Client Manager Email",
              "displayName": "Client Manager Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        864,
        176
      ],
      "id": "80c3999e-feb9-4e72-a12f-6bd0866db0b0",
      "name": "Append row in Sentiment_Alerts",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TmejcAPR1YSqhJ6Y",
          "name": "Google Sheets account 2"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Switch node for the response from Agents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        []
      ]
    },
    "if response from AI Agent and downtime > 4": {
      "main": [
        [
          {
            "node": "Append row in AI_Agent_Alerts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If response from SQL QA System with some conditions": {
      "main": [
        [
          {
            "node": "Append row in SQL_QA_Alerts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If response from Sentiment Summarizer and sentiment is low": {
      "main": [
        [
          {
            "node": "Append row in Sentiment_Alerts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch node for the response from Agents": {
      "main": [
        [
          {
            "node": "if response from AI Agent and downtime > 4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If response from SQL QA System with some conditions",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If response from Sentiment Summarizer and sentiment is low",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in AI_Agent_Alerts": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in SQL_QA_Alerts": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in Sentiment_Alerts": {
      "main": [
        [
          {
            "node": "Send a message2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "36c6fb20-edfe-4ff4-a2d3-3328a7cb3551",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "3243852d725c0719c39c3301b7a243ec624a189c3c8e5983445ecefd6bb2fa41"
  },
  "id": "W4bbgKqSRsQj5RSg",
  "tags": []
}